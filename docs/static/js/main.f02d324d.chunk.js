(window["webpackJsonpbrowndust-share"]=window["webpackJsonpbrowndust-share"]||[]).push([[0],{35:function(e){e.exports=JSON.parse("{}")},36:function(e){e.exports=JSON.parse("{}")},37:function(e){e.exports=JSON.parse("{}")},38:function(e,t,n){!function(t){"use strict";var n=function(){return{escape:function(e){return e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")},parseExtension:e,mimeType:function(t){var n=e(t).toLowerCase();return function(){var e="application/font-woff";return{woff:e,woff2:e,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}()[n]||""},dataAsUrl:function(e,t){return"data:"+t+";base64,"+e},isDataUrl:function(e){return-1!==e.search(/^(data:)/)},canvasToBlob:function(e){return e.toBlob?new Promise(function(t){e.toBlob(t)}):function(e){return new Promise(function(t){for(var n=window.atob(e.toDataURL().split(",")[1]),r=n.length,a=new Uint8Array(r),o=0;o<r;o++)a[o]=n.charCodeAt(o);t(new Blob([a],{type:"image/png"}))})}(e)},resolveUrl:function(e,t){var n=document.implementation.createHTMLDocument(),r=n.createElement("base");n.head.appendChild(r);var a=n.createElement("a");return n.body.appendChild(a),r.href=t,a.href=e,a.href},getAndEncode:function(e){var t=3e4;i.impl.options.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+(new Date).getTime());return new Promise(function(n){var r,a=new XMLHttpRequest;if(a.onreadystatechange=function(){if(4!==a.readyState)return;if(200!==a.status)return void(r?n(r):c("cannot fetch resource: "+e+", status: "+a.status));var t=new FileReader;t.onloadend=function(){var e=t.result.split(/,/)[1];n(e)},t.readAsDataURL(a.response)},a.ontimeout=function(){r?n(r):c("timeout of "+t+"ms occured while fetching resource: "+e)},a.responseType="blob",a.timeout=t,a.open("GET",e,!0),a.send(),i.impl.options.imagePlaceholder){var o=i.impl.options.imagePlaceholder.split(/,/);o&&o[1]&&(r=o[1])}function c(e){console.error(e),n("")}})},uid:function(){var e=0;return function(){return"u"+("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)+e++}}(),delay:function(e){return function(t){return new Promise(function(n){setTimeout(function(){n(t)},e)})}},asArray:function(e){return Array.prototype.slice.call(e)},escapeXhtml:function(e){return e.replace(/#/g,"%23").replace(/\n/g,"%0A")},makeImage:function(e){return new Promise(function(t,n){var r=new Image;r.onload=function(){t(r)},r.onerror=n,r.src=e})},width:function(e){var n=t(e,"border-left-width"),r=t(e,"border-right-width");return e.scrollWidth+n+r},height:function(e){var n=t(e,"border-top-width"),r=t(e,"border-bottom-width");return e.scrollHeight+n+r}};function e(e){var t=/\.([^\.\/]*?)$/g.exec(e);return t?t[1]:""}function t(e,t){var n=window.getComputedStyle(e).getPropertyValue(t);return parseFloat(n.replace("px",""))}}(),r=function(){var e=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:function(e,n,o){return function(){return!t(e)}()?Promise.resolve(e):Promise.resolve(e).then(r).then(function(t){var r=Promise.resolve(e);return t.forEach(function(e){r=r.then(function(t){return a(t,e,n,o)})}),r})},shouldProcess:t,impl:{readUrls:r,inline:a}};function t(t){return-1!==t.search(e)}function r(t){for(var r,a=[];null!==(r=e.exec(t));)a.push(r[1]);return a.filter(function(e){return!n.isDataUrl(e)})}function a(e,t,r,a){return Promise.resolve(t).then(function(e){return r?n.resolveUrl(e,r):e}).then(a||n.getAndEncode).then(function(e){return n.dataAsUrl(e,n.mimeType(t))}).then(function(r){return e.replace(function(e){return new RegExp("(url\\(['\"]?)("+n.escape(e)+")(['\"]?\\))","g")}(t),"$1"+r+"$3")})}}(),a=function(){return{resolveAll:function(){return e(document).then(function(e){return Promise.all(e.map(function(e){return e.resolve()}))}).then(function(e){return e.join("\n")})},impl:{readAll:e}};function e(){return Promise.resolve(n.asArray(document.styleSheets)).then(function(e){var t=[];return e.forEach(function(e){try{n.asArray(e.cssRules||[]).forEach(t.push.bind(t))}catch(r){console.log("Error while reading CSS rules from "+e.href,r.toString())}}),t}).then(function(e){return e.filter(function(e){return e.type===CSSRule.FONT_FACE_RULE}).filter(function(e){return r.shouldProcess(e.style.getPropertyValue("src"))})}).then(function(t){return t.map(e)});function e(e){return{resolve:function(){var t=(e.parentStyleSheet||{}).href;return r.inlineAll(e.cssText,t)},src:function(){return e.style.getPropertyValue("src")}}}}}(),o=function(){return{inlineAll:function t(a){if(!(a instanceof Element))return Promise.resolve(a);return function(e){var t=e.style.getPropertyValue("background");return t?r.inlineAll(t).then(function(t){e.style.setProperty("background",t,e.style.getPropertyPriority("background"))}).then(function(){return e}):Promise.resolve(e)}(a).then(function(){return a instanceof HTMLImageElement?e(a).inline():Promise.all(n.asArray(a.childNodes).map(function(e){return t(e)}))})},impl:{newImage:e}};function e(e){return{inline:function(t){return n.isDataUrl(e.src)?Promise.resolve():Promise.resolve(e.src).then(t||n.getAndEncode).then(function(t){return n.dataAsUrl(t,n.mimeType(e.src))}).then(function(t){return new Promise(function(n,r){e.onload=n,e.onerror=r,e.src=t})})}}}}(),c={imagePlaceholder:void 0,cacheBust:!1},i={toSvg:u,toPng:function(e,t){return l(e,t||{}).then(function(e){return e.toDataURL()})},toJpeg:function(e,t){return l(e,t=t||{}).then(function(e){return e.toDataURL("image/jpeg",t.quality||1)})},toBlob:function(e,t){return l(e,t||{}).then(n.canvasToBlob)},toPixelData:function(e,t){return l(e,t||{}).then(function(t){return t.getContext("2d").getImageData(0,0,n.width(e),n.height(e)).data})},impl:{fontFaces:a,images:o,util:n,inliner:r,options:{}}};function u(e,t){return function(e){"undefined"===typeof e.imagePlaceholder?i.impl.options.imagePlaceholder=c.imagePlaceholder:i.impl.options.imagePlaceholder=e.imagePlaceholder;"undefined"===typeof e.cacheBust?i.impl.options.cacheBust=c.cacheBust:i.impl.options.cacheBust=e.cacheBust}(t=t||{}),Promise.resolve(e).then(function(e){return function(e,t,n){if(!n&&t&&!t(e))return Promise.resolve();return Promise.resolve(e).then(function(e){return e instanceof HTMLCanvasElement?n.makeImage(e.toDataURL()):e.cloneNode(!1)}).then(function(n){return function(e,t,r){var a=e.childNodes;return 0===a.length?Promise.resolve(t):function(e,t,n){var r=Promise.resolve();return t.forEach(function(e){r=r.then(function(){return s(e,n)}).then(function(e){e&&e.appendChild(e)})}),r}(t,n.asArray(a),r).then(function(){return t})}(e,n,t)}).then(function(t){return function(e,t){return t instanceof Element?Promise.resolve().then(function(){source=window.getComputedStyle(e),target=t.style,source.cssText?target.cssText=source.cssText:function(e,t){n.asArray(e).forEach(function(n){t.setProperty(n,e.getPropertyValue(n),e.getPropertyPriority(n))})}(source,target);var e,t}).then(function(){[":before",":after"].forEach(function(e){!function(e){var t=window.getComputedStyle(e,e),r=t.getPropertyValue("content");if(""!==r&&"none"!==r){var a=n.uid();t.className=t.className+" "+a;var o=document.createElement("style");o.appendChild(function(e,t,r){var a="."+e+":"+t,o=r.cssText?function(e){var t=e.getPropertyValue("content");return e.cssText+" content: "+t+";"}(r):function(e){return n.asArray(e).map(function(t){return t+": "+e.getPropertyValue(t)+(e.getPropertyPriority(t)?" !important":"")}).join("; ")+";"}(r);return document.createTextNode(a+"{"+o+"}")}(a,e,t)),t.appendChild(o)}}(e)})}).then(function(){e instanceof HTMLTextAreaElement&&(t.innerHTML=e.value);e instanceof HTMLInputElement&&t.setAttribute("value",e.value)}).then(function(){if(!(t instanceof SVGElement))return;if(t.setAttribute("xmlns","http://www.w3.org/2000/svg"),!(t instanceof SVGRectElement))return;["width","height"].forEach(function(e){var t=t.getAttribute(e);t&&t.style.setProperty(e,t)})}).then(function(){return t}):t}(e,t)})}(e,t.filter,!0)}).then(d).then(f).then(function(e){t.bgcolor&&(e.style.backgroundColor=t.bgcolor);t.width&&(e.style.width=t.width+"px");t.height&&(e.style.height=t.height+"px");t.style&&Object.keys(t.style).forEach(function(n){e.style[n]=t.style[n]});return e}).then(function(r){return function(e,t,r){return Promise.resolve(e).then(function(e){return e.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),(new XMLSerializer).serializeToString(e)}).then(n.escapeXhtml).then(function(e){return'<foreignObject x="0" y="0" width="100%" height="100%">'+e+"</foreignObject>"}).then(function(e){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+t+'" height="'+r+'">'+e+"</svg>"}).then(function(e){return"data:image/svg+xml;charset=utf-8,"+e})}(r,t.width||n.width(e),t.height||n.height(e))})}function l(e,t){return u(e,t).then(n.makeImage).then(n.delay(100)).then(function(r){var a=function(e){var r=document.createElement("canvas");if(r.width=t.width||n.width(e),r.height=t.height||n.height(e),t.bgcolor){var a=r.getContext("2d");a.fillStyle=t.bgcolor,a.fillRect(0,0,r.width,r.height)}return r}(e);return a.getContext("2d").drawImage(r,0,0),a})}function s(e,t,r){if(!r&&t&&!t(e))return Promise.resolve();return Promise.resolve(e).then(a).then(function(n){return o(e,n,t)}).then(function(t){return c(e,t)});function a(e){return e instanceof HTMLCanvasElement?n.makeImage(e.toDataURL()):e.cloneNode(!1)}function o(e,t,r){var a=e.childNodes;return 0===a.length?Promise.resolve(t):function(e,t,n){var r=Promise.resolve();return t.forEach(function(e){r=r.then(function(){return s(e,n)}).then(function(e){e&&e.appendChild(e)})}),r}(t,n.asArray(a),r).then(function(){return t});function o(e,t,n){var r=Promise.resolve();return t.forEach(function(e){r=r.then(function(){return s(e,n)}).then(function(e){e&&e.appendChild(e)})}),r}}function c(e,t){return t instanceof Element?Promise.resolve().then(function(){source=window.getComputedStyle(e),target=t.style,source.cssText?target.cssText=source.cssText:function(e,t){n.asArray(e).forEach(function(n){t.setProperty(n,e.getPropertyValue(n),e.getPropertyPriority(n))})}(source,target);var e,t}).then(function(){[":before",":after"].forEach(function(e){!function(e){var t=window.getComputedStyle(e,e),r=t.getPropertyValue("content");if(""!==r&&"none"!==r){var a=n.uid();t.className=t.className+" "+a;var o=document.createElement("style");o.appendChild(function(e,t,r){var a="."+e+":"+t,o=r.cssText?function(e){var t=e.getPropertyValue("content");return e.cssText+" content: "+t+";"}(r):function(e){return n.asArray(e).map(function(t){return t+": "+e.getPropertyValue(t)+(e.getPropertyPriority(t)?" !important":"")}).join("; ")+";"}(r);return document.createTextNode(a+"{"+o+"}")}(a,e,t)),t.appendChild(o)}}(e)})}).then(function(){e instanceof HTMLTextAreaElement&&(t.innerHTML=e.value);e instanceof HTMLInputElement&&t.setAttribute("value",e.value)}).then(function(){if(!(t instanceof SVGElement))return;if(t.setAttribute("xmlns","http://www.w3.org/2000/svg"),!(t instanceof SVGRectElement))return;["width","height"].forEach(function(e){var t=t.getAttribute(e);t&&t.style.setProperty(e,t)})}).then(function(){return t}):t;function r(){function r(e,t){e.cssText?t.cssText=e.cssText:function(e,t){n.asArray(e).forEach(function(n){t.setProperty(n,e.getPropertyValue(n),e.getPropertyPriority(n))})}(e,t)}source=window.getComputedStyle(e),target=t.style,void(source.cssText?target.cssText=source.cssText:function(e,t){n.asArray(e).forEach(function(n){t.setProperty(n,e.getPropertyValue(n),e.getPropertyPriority(n))})}(source,target))}function a(){function r(e){var t=window.getComputedStyle(e,e),r=t.getPropertyValue("content");if(""!==r&&"none"!==r){var a=n.uid();t.className=t.className+" "+a;var o=document.createElement("style");o.appendChild(function(e,t,r){var a="."+e+":"+t,o=r.cssText?function(e){var t=e.getPropertyValue("content");return e.cssText+" content: "+t+";"}(r):function(e){return n.asArray(e).map(function(t){return t+": "+e.getPropertyValue(t)+(e.getPropertyPriority(t)?" !important":"")}).join("; ")+";"}(r);return document.createTextNode(a+"{"+o+"}")}(a,e,t)),t.appendChild(o)}}[":before",":after"].forEach(function(e){!function(e){var t=window.getComputedStyle(e,e),r=t.getPropertyValue("content");if(""!==r&&"none"!==r){var a=n.uid();t.className=t.className+" "+a;var o=document.createElement("style");o.appendChild(function(e,t,r){var a="."+e+":"+t,o=r.cssText?function(e){var t=e.getPropertyValue("content");return e.cssText+" content: "+t+";"}(r):function(e){return n.asArray(e).map(function(t){return t+": "+e.getPropertyValue(t)+(e.getPropertyPriority(t)?" !important":"")}).join("; ")+";"}(r);return document.createTextNode(a+"{"+o+"}")}(a,e,t)),t.appendChild(o)}}(e)})}function o(){if(e instanceof HTMLTextAreaElement)t.innerHTML=e.value;if(e instanceof HTMLInputElement)t.setAttribute("value",e.value)}function c(){if(!(t instanceof SVGElement))return;if(t.setAttribute("xmlns","http://www.w3.org/2000/svg"),!(t instanceof SVGRectElement))return;["width","height"].forEach(function(e){var t=t.getAttribute(e);t&&t.style.setProperty(e,t)})}}}function d(e){return a.resolveAll().then(function(t){var n=document.createElement("style");return e.appendChild(n),n.appendChild(document.createTextNode(t)),e})}function f(e){return o.inlineAll(e).then(function(){return e})}e.exports=i}()},40:function(e,t,n){e.exports=n(77)},52:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},76:function(e,t,n){},77:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),o=n(18),c=n.n(o),i=n(11),u=n(2),l=n(30),s=(n(52),n(26)),d=n(39),f=n(34),p=n.n(f),h={en:{translation:n(35)},zhTW:{translation:n(36)},zhCN:{translation:n(37)}};s.a.use(p.a).use(d.a).init({resources:h,lng:"en",keySeparator:!1,interpolation:{escapeValue:!1}});s.a;var m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CHARACTERS":return t.payload;default:return e}},g=n(15);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(n,!0).forEach(function(t){Object(g.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var b={formation:[{id:"a1",top:"9px",left:"13px",type:0,backgroundImage:null,code:null,dragOver:!1},{id:"a2",top:"9px",left:"127.5px",type:0,backgroundImage:null,code:null,dragOver:!1},{id:"a3",top:"9px",left:"242px",type:0,backgroundImage:null,code:null,dragOver:!1},{id:"a4",top:"9px",left:"356px",type:0,backgroundImage:null,code:null,dragOver:!1},{id:"a5",top:"9px",left:"471px",type:0,backgroundImage:null,code:null,dragOver:!1},{id:"a6",top:"9px",left:"585.5px",type:0,backgroundImage:null,code:null,dragOver:!1},{id:"b1",top:"122.5px",left:"13px",type:0,backgroundImage:null,code:null,dragOver:!1},{id:"b2",top:"122.5px",left:"127.5px",type:0,backgroundImage:null,code:null,dragOver:!1},{id:"b3",top:"122.5px",left:"242px",type:0,backgroundImage:null,code:null,dragOver:!1},{id:"b4",top:"122.5px",left:"356px",type:0,backgroundImage:null,code:null,dragOver:!1},{id:"b5",top:"122.5px",left:"471px",type:0,backgroundImage:null,code:null,dragOver:!1},{id:"b6",top:"122.5px",left:"585.5px",type:0,backgroundImage:null,code:null,dragOver:!1},{id:"c1",top:"239px",left:"13px",type:0,backgroundImage:null,code:null,dragOver:!1},{id:"c2",top:"239px",left:"127.5px",type:0,backgroundImage:null,code:null,dragOver:!1},{id:"c3",top:"239px",left:"242px",type:0,backgroundImage:null,code:null,dragOver:!1},{id:"c4",top:"239px",left:"356px",type:0,backgroundImage:null,code:null,dragOver:!1},{id:"c5",top:"239px",left:"471px",type:0,backgroundImage:null,code:null,dragOver:!1},{id:"c6",top:"239px",left:"585.5px",type:0,backgroundImage:null,code:null,dragOver:!1}],options:{type:!0,backcolor:!0,backimage:!0,order:!0}},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"RESET_FORMATION":case"UPDATE_FORMATION":return y({},e,{},t.payload);default:return e}},O=Object(i.c)({dataset:w,characters:m}),k=n(3),E=n(4),P=n(7),x=n(5),j=n(6),C=(n(70),n(71),function(e){function t(){return Object(k.a)(this,t),Object(P.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(j.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){return a.a.createElement("header",{id:"header"},a.a.createElement("center",null,a.a.createElement("h1",null,"BROWNDUST ",a.a.createElement("small",null,"\u68d5\u8272\u5875\u57c3 \xd7 \u9663\u578b\u5206\u4eab"))))}}]),t}(r.Component)),S=Object(u.b)(function(e){return{}})(C),T=(n(72),n(21)),D=n.n(T),N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return D.a.session(e)},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return D.a.session.remove(e)},I="http://robby570.tw/browndust-share/resource/thumbnail",R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.split("*")[1];return"".concat(I,"/").concat(t,".png")},V=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t/2;return new Promise(function(r){var a=document.createElement("img");a.onload=function(){var e=document.createElement("canvas"),o=e.getContext("2d");null!==t&&(e.width=t),null!==n&&(e.height=n),o.drawImage(a,0,0,t,n);var c=e.toDataURL();r(c)},a.src=e,a.crossOrigin="anonymous"})},L=function(e){return{type:"UPDATE_FORMATION",payload:e}};function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(n,!0).forEach(function(t){Object(g.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var _=function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(P.a)(this,Object(x.a)(t).call(this,e))).onDragStart=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.dataTransfer.setData("scode",t),e.dataTransfer.setData("sid",n)},n.onDragOver=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.preventDefault()},n.onDragEnter=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e.preventDefault(),n.onDragChangeStyle(t,!0)},n.onDragLeave=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e.preventDefault(),n.onDragChangeStyle(t,!1)},n.onDrop=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=e.dataTransfer.getData("sid"),a=e.dataTransfer.getData("scode"),o=n.formation.find(function(e){return e.id===t});n.onCheckExistImage(!0,t,r,a)||(null===o.backgroundImage?(n.onAddImage(t,a),n.onRemoveImage(r,a)):(n.onAddImage(r,o.code),n.onAddImage(t,a)))},n.onDragEnd=function(e,t,n){e.preventDefault()},n.props=e,n.dispatch=e.dispatch,n.state={alertID:null,alertTimer:null},n}return Object(j.a)(t,e),Object(E.a)(t,[{key:"onAddImage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.characters.find(function(e){return e._code===t});(t||n)&&(this.formation=this.formation.map(function(r){return r.id===e?z({},r,{backgroundImage:"url(".concat(R(n._uiIconImageName),")"),type:Number(n._type),code:t,dragOver:!1}):r}),this.dispatch(L({formation:this.formation})))}},{key:"onRemoveImage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.characters.find(function(e){return e._code===t});(t||n)&&(this.formation=this.formation.map(function(t){return t.id===e?z({},t,{backgroundImage:null,type:null,code:null,dragOver:!1}):t}),this.dispatch(L({formation:this.formation})))}},{key:"onCheckExistImage",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3?arguments[3]:void 0,o=!1,c=this.formation.filter(function(e){return e.code===a});return e&&"0"===r&&c.length>0?o=!0:!e&&c.length>0&&(o=!0),!!o&&(this.setState({alertID:c[0].id}),setTimeout(function(){n.setState({alertID:null})},1e3),this.onDragChangeStyle(t,!1),A("_code"),console.warn("already have!"),!0)}},{key:"onDragChangeStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!1;this.formation=this.formation.map(function(r){return r.id===e?(r.dragOver!==t&&(n=!0),z({},r,{dragOver:t})):r}),n&&this.dispatch(L({formation:this.formation}))}},{key:"onFormationClick",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=N("_code");t&&(this.onCheckExistImage(!1,e,null,t)||(this.onAddImage(e,t),A("_code")))}},{key:"renderFormation",value:function(){var e=this;return this.formation.map(function(t){var n=t.id,r=t.top,o=t.left,c=t.type,i=t.backgroundImage,u=t.code,l=t.dragOver;return a.a.createElement("div",{key:"formation-".concat(n),className:"box ".concat(l?"over":""," ").concat(e.state.alertID===n?"shake-hard shake-constant shake-constant--hover":""),id:n,"data-type":c,draggable:!!u,style:{top:r,left:o,backgroundImage:i},onClick:function(){return e.onFormationClick(n)},onDoubleClick:function(){return e.onRemoveImage(n,u)},onDragStart:function(t){return e.onDragStart(t,u,n)},onDragOver:function(t){return e.onDragOver(t,n)},onDragEnter:function(t){return e.onDragEnter(t,n)},onDragLeave:function(t){return e.onDragLeave(t,n)},onDrop:function(t){e.onDrop(t,n)},onDragEnd:function(t){return e.onDragEnd(t,n,u)}},a.a.createElement("div",{className:"type","data-type":c}))})}},{key:"render",value:function(){this.formation=this.props.dataset.formation;var e=this.props.dataset.options,t=e.type,n=e.backcolor,r=e.backimage,o=e.order;return this.characters=this.props.characters,a.a.createElement("div",{id:"formation",className:"formation \n        ".concat(t?"":"no-type","\n        ").concat(n?"":"no-backcolor","\n        ").concat(r?"":"no-backimage","\n        ").concat(o?"":"no-order","\n        ")},this.renderFormation())}}]),t}(r.Component),M=Object(u.b)(function(e){return{characters:e.characters,dataset:e.dataset}})(_),B=(n(73),n(10)),F=n(24),H=(n(74),function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(P.a)(this,Object(x.a)(t).call(this,e))).onDragStart=function(e,t,n){e.dataTransfer.setData("scode",t),e.dataTransfer.setData("sid",n)},n.props=e,n.state={},n}return Object(j.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){var e=this,t=this.props.params,n=t._uiIconImageName,r=t._charName_TW,o=t._code,c=R(n);return a.a.createElement("div",{className:"mercenary",style:{backgroundImage:"url(".concat(c,")")},"data-tooltip":r,draggable:!0,onClick:function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;(e||t)&&D.a.session(e,t)}("_code",o)},onDragStart:function(t){return e.onDragStart(t,o,0)}})}}]),t}(r.Component)),G=Object(u.b)(function(e){return{}})(H),J=function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(P.a)(this,Object(x.a)(t).call(this,e))).onStarChange=function(e){var t=n.state.stars,r=t.find(function(t){return t.label===e});r.checked=!r.checked,n.setState({stars:t})},n.onNameOptionsChange=function(e){var t=n.state.nameOptions,r=t.find(function(t){return t.label===e});r.checked=!r.checked,n.setState({nameOptions:t})},n.props=e,n.state={type:1,types:[{type:1,style:"attacker",label:"\u653b\u64ca"},{type:2,style:"defender",label:"\u9632\u79a6"},{type:3,style:"magician",label:"\u9b54\u6cd5"},{type:4,style:"supporter",label:"\u652f\u63f4"}],stars:[{label:"5\u661f",checked:!0,star:5},{label:"4\u661f",checked:!0,star:4},{label:"3\u661f",checked:!1,star:3},{label:"\u4e00\u822c",checked:!1,star:2}],nameOptions:[{label:"\u986f\u793a",checked:!0},{label:"\u7c97\u9ad4",checked:!1}]},n}return Object(j.a)(t,e),Object(E.a)(t,[{key:"renderTypes",value:function(){var e=this;return this.state.types.map(function(t){var n=t.type,r=t.style,o=t.label;return a.a.createElement("button",{key:"type-".concat(o),type:"button",className:"type ".concat(r," ").concat(n===e.state.type?"active":""),onClick:function(){return e.setState({type:n})}},a.a.createElement("i",null),a.a.createElement("span",null,o))})}},{key:"renderFilterStars",value:function(){var e=this;return this.state.stars.map(function(t,n){var r=t.label,o=t.checked;return a.a.createElement(B.Checkbox,{key:"start-".concat(n),shape:"round",color:"info",animation:"jelly",icon:a.a.createElement("i",{className:"mdi mdi-check"}),checked:o,onChange:function(){return e.onStarChange(r)}},r)})}},{key:"renderFilterNameOptions",value:function(){var e=this;return this.state.nameOptions.map(function(t,n){var r=t.label,o=t.checked;return a.a.createElement(B.Checkbox,{key:"name-".concat(n),shape:"round",color:"info",animation:"jelly",icon:a.a.createElement("i",{className:"mdi mdi-check"}),checked:o,onChange:function(){return e.onNameOptionsChange(r)}},r)})}},{key:"renderCharacters",value:function(){var e=this;return this.props.characters.filter(function(t){var n=t._type,r=t._growType,a=t._star;return Number(n)===e.state.type&&Number(r)>=0&&(e.state.stars[0].checked&&5===Number(a)||e.state.stars[1].checked&&4===Number(a)||e.state.stars[2].checked&&3===Number(a)||e.state.stars[3].checked&&2===Number(a)||e.state.stars[3].checked&&1===Number(a))}).map(function(t,n){return a.a.createElement(G,{key:"mercenary-".concat(n),params:t,nameOptions:e.state.nameOptions})})}},{key:"render",value:function(){return a.a.createElement("div",{className:"list"},a.a.createElement("div",{className:"types"},this.renderTypes()),a.a.createElement("div",{className:"filter"},a.a.createElement("div",{className:"star"},a.a.createElement("span",{className:"filter-title"},a.a.createElement(F.b,null)," \u661f\u7d1a\uff1a"),this.renderFilterStars()),a.a.createElement("div",{className:"name"},a.a.createElement("span",{className:"filter-title"},a.a.createElement(F.a,null)," \u540d\u7a31\uff1a"),this.renderFilterNameOptions())),a.a.createElement("div",{className:"content\n          ".concat(this.state.nameOptions[0].checked?"show":""," \n          ").concat(this.state.nameOptions[1].checked?"bold":"","\n          ")},this.renderCharacters()))}}]),t}(r.Component),W=Object(u.b)(function(e){return{characters:e.characters}})(J),$=n(16),X=n.n($),q=n(20),K=(n(76),n(25)),Q=n(38),Y=n.n(Q);function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(n,!0).forEach(function(t){Object(g.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var te=function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(P.a)(this,Object(x.a)(t).call(this,e))).dispatch=e.dispatch,n.state={downloadSizeSelected:2,downloadSizeCustom:null,downloadSize:[{value:1,name:700},{value:2,name:500},{value:3,name:300},{value:4,name:"\u81ea\u8a02\u5bec\u5ea6"}]},n}return Object(j.a)(t,e),Object(E.a)(t,[{key:"onUpdateOptions",value:function(e){var t=ee({},this.options,{},e);this.dispatch(L({options:t}))}},{key:"onDownloadClick",value:function(){var e=this,t=document.getElementById("formation");Y.a.toPng(t).then(function(){var t=Object(q.a)(X.a.mark(function t(n){var r,a,o;return X.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!((r=4!==e.state.downloadSizeSelected?e.state.downloadSize.find(function(t){return t.value===e.state.downloadSizeSelected}).name:Number(e.state.downloadSizeCustom))<=0)){t.next=3;break}return t.abrupt("return");case 3:return a=document.createElement("a"),t.next=6,V(n,r);case 6:o=t.sent,a.href=o,a.download="output.png",document.body.appendChild(a),a.click(),document.body.removeChild(a);case 12:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()).catch(function(e){return console.error("domtoimage wrong",e)})}},{key:"render",value:function(){var e=this;return this.options=this.props.dataset.options,a.a.createElement("div",{className:"toolbar"},a.a.createElement("div",{className:"options"},"\u986f\u793a\u5167\u5bb9\uff1a",a.a.createElement(B.Checkbox,{shape:"round",color:"info",animation:"jelly",icon:a.a.createElement("i",{className:"mdi mdi-check"}),checked:this.options.type,onChange:function(t){return e.onUpdateOptions({type:t.target.checked})}},"\u50ad\u5175\u985e\u578b"),a.a.createElement(B.Checkbox,{shape:"round",color:"info",animation:"jelly",icon:a.a.createElement("i",{className:"mdi mdi-check"}),checked:this.options.order,onChange:function(t){return e.onUpdateOptions({order:t.target.checked})}},"\u51fa\u624b\u9806\u5e8f"),a.a.createElement(B.Checkbox,{shape:"round",color:"info",animation:"jelly",icon:a.a.createElement("i",{className:"mdi mdi-check"}),checked:this.options.backcolor,onChange:function(t){return e.onUpdateOptions({backcolor:t.target.checked})}},"\u80cc\u666f\u984f\u8272"),a.a.createElement(B.Checkbox,{shape:"round",color:"info",animation:"jelly",icon:a.a.createElement("i",{className:"mdi mdi-check"}),checked:this.options.backimage,onChange:function(t){return e.onUpdateOptions({backimage:t.target.checked})}},"\u80cc\u666f\u65b9\u683c")),a.a.createElement("div",{className:"options"},"\u5716\u7247\u5bec\u5ea6\uff1a",this.state.downloadSize.map(function(t){var n=t.value,r=t.name;return a.a.createElement(B.Radio,{key:"download-szie-".concat(n),name:"download-size",shape:"round",color:"info",animation:"jelly",icon:a.a.createElement("i",{className:"mdi mdi-check"}),value:n,checked:n===e.state.downloadSizeSelected,onChange:function(){return e.setState({downloadSizeSelected:n})}},4!==n?"".concat(r,"px"):r)}),a.a.createElement("input",{className:"download-size-custom",defaultValue:this.state.downloadSizeCustom,onChange:function(t){return e.setState({downloadSizeCustom:t.target.value})},onFocus:function(){return e.setState({downloadSizeSelected:4})}})),a.a.createElement("div",{className:"commands"},a.a.createElement("button",{type:"button",className:"tool attacker",onClick:function(){var t=e.props.dataset.formation.map(function(e){return ee({},e,{type:0,backgroundImage:null,code:null,dragOver:!1})});e.dispatch(L({formation:t}))}},a.a.createElement(K.b,{size:"2em",color:"#fff"}),a.a.createElement("span",null,"\u91cd\u7f6e")),a.a.createElement("button",{type:"button",className:"tool attacker",onClick:function(){return e.onDownloadClick()}},a.a.createElement(K.a,{size:"2em",color:"#fff"}),a.a.createElement("span",null,"\u4e0b\u8f09"))))}}]),t}(r.Component),ne=Object(u.b)(function(e){return{dataset:e.dataset}})(te),re=function(){var e=Object(q.a)(X.a.mark(function e(){return X.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("https://browndust-global-api.pmang.cloud/book/getAllCharacters").then(function(e){return e.json()||[]}));case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),ae=function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(P.a)(this,Object(x.a)(t).call(this,e))).dispatch=e.dispatch,n}return Object(j.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){var e=this;re().then(function(t){return e.dispatch({type:"SET_CHARACTERS",payload:t})})}},{key:"render",value:function(){return this.database=this.props.database,this.users=this.props.users,a.a.createElement("div",{id:"wrapper"},a.a.createElement(S,null),a.a.createElement("section",{id:"container"},a.a.createElement("div",{className:"main"},a.a.createElement(M,null),a.a.createElement(ne,null)),a.a.createElement(W,null)))}}]),t}(r.Component),oe=Object(u.b)(function(e){return{characters:e.characters}})(ae);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ce=Object(i.d)(O,Object(i.a)(l.a));c.a.render(a.a.createElement(u.a,{store:ce},a.a.createElement(oe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[40,1,2]]]);
//# sourceMappingURL=main.f02d324d.chunk.js.map